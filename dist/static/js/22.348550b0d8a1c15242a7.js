webpackJsonp([22],{"5ybE":function(e,t,r){"use strict";t.b=function(e){return Object(s.a)({url:a.a.GET_DEPARTMENT_LIST_URL,method:"post",data:e})},t.c=function(e){return Object(s.a)({url:a.a.GET_USERLIST_BY_DEPARTMENTID_URL,method:"post",data:{departmentId:e}})},t.a=function(e){return Object(s.a)({url:a.a.GET_DEPARTMENT_AUTHOTIZE_URL,method:"post",data:e})};var s=r("vLgD"),a=r("FN8c")},AE1b:function(e,t,r){var s=r("EywL");"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);r("8bSs")("34116972",s,!0)},EywL:function(e,t,r){(e.exports=r("BkJT")(!1)).push([e.i,"\n.dashboard-editor-container[data-v-0d70993e] {\n  padding: 32px;\n}\n",""])},qssE:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("vMJZ"),a=r("Odk1"),n=r("5ybE"),i=r("dVeB"),o={components:{},data:function(){return{listLoading:!1,departmentLoading:!1,userLoading:!1,isVisible:!1,total:100,allUser:[],userList:[],deparmentList:[],projectList:[],listQuery:{userNum:"",mobile:"",userName:"",departmentId:"",pageIndex:1,pageSize:10},userForm:{deparmentId:"",projectIds:[],userId:""},rules:{deparmentId:[{required:!0,message:"请选择部门",trigger:"change"}],userId:[{required:!0,message:"请选择员工",trigger:"change"}],projectIds:[{type:"array",required:!0,message:"请至少选择一个项目",trigger:"change"}]},departmentTree:[]}},methods:{getUserListSearch:function(){this.getUserList()},handleNodeClick:function(e){this.listQuery.departmentId=e.id,this.getUserList()},changeDepartment:function(e){var t=this;Object(n.c)(e).then(function(e){t.allUser=e.dataObject.usersList}).catch(function(e){408===e.status?t.$router.push("/408"):Object(i.Message)({message:e,type:"error",duration:3e3})})},allotProject:function(){this.isVisible=!0,this.userForm={},this.getDepartmentList()},getUserList:function(){var e=this;Object(s.getUserList)(this.listQuery).then(function(t){e.userList=t.dataObject.userList,e.total=t.dataObject.total}).catch(function(t){408===t.status?e.$router.push("/408"):Object(i.Message)({message:t,type:"error",duration:3e3})})},getDepartmentTree:function(){var e=this;Object(s.getDepartmentTree)().then(function(t){e.departmentTree=t.dataObject.departmentTree,console.log(e.departmentTree)}).catch(function(t){408===t.status?e.$router.push("/408"):Object(i.Message)({message:t,type:"error",duration:3e3})})},getAllUserList:function(){var e=this;Object(s.getUserList)(this.listQuery).then(function(t){e.allUser=t.dataObject.userList}).catch(function(t){408===t.status?e.$router.push("/408"):Object(i.Message)({message:t,type:"error",duration:3e3})})},handleSizeChange:function(e){this.listQuery.pageSize=e,this.getUserList()},handleCurrentChange:function(e){this.listQuery.pageIndex=e,this.getUserList()},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){e&&Object(s.saveOrUpdateUserProject)(t.userForm).then(function(e){t.isVisible=!1,t.userForm={},t.getUserList(),Object(i.Message)({message:"success~",type:"success",duration:3e3})}).catch(function(e){408===e.status?t.$router.push("/408"):Object(i.Message)({message:e,type:"error",duration:3e3})})})},projectListAll:function(e){var t=this;Object(a.d)().then(function(r){t.projectList=r.dataObject.projectsList,t.getUserProject(e)}).catch(function(e){t.$router.push("/408")})},getDepartmentList:function(){var e=this;Object(n.b)().then(function(t){e.deparmentList=t.dataObject.departmentsList}).catch(function(t){408===t.status?e.$router.push("/408"):Object(i.Message)({message:t,type:"error",duration:3e3})})},changeUser:function(e){this.userForm.projectIds=[],this.projectListAll(e)},getUserProject:function(e){var t=this;Object(s.userProjectList)(e).then(function(e){var r=e.dataObject.projectList,s=[];r&&r.length>0&&(r.forEach(function(e){s.push(e.id)}),t.userForm.projectIds=s)})}},mounted:function(){this.getUserList(),this.getDepartmentTree()}},l={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"dashboard-editor-container"},[r("el-container",[r("el-header",[r("div",{staticClass:"search_form"},[r("el-form",{ref:"form",attrs:{model:e.listQuery,"label-width":"80px"}},[r("el-row",[r("el-col",{attrs:{span:6,offset:"4"}},[r("el-form-item",{attrs:{label:"用户名"}},[r("el-input",{attrs:{placeholder:"用户名"},model:{value:e.listQuery.userName,callback:function(t){e.$set(e.listQuery,"userName",t)},expression:"listQuery.userName"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:5}},[r("el-form-item",{attrs:{label:"手机号"}},[r("el-input",{attrs:{placeholder:"手机号"},model:{value:e.listQuery.mobile,callback:function(t){e.$set(e.listQuery,"mobile",t)},expression:"listQuery.mobile"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:2}},[r("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small",round:"",icon:"el-icon-search"},on:{click:function(t){e.getUserListSearch()}}},[e._v("搜索")])],1),e._v(" "),r("el-col",{attrs:{span:2}},[r("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small",round:""},on:{click:e.allotProject}},[e._v("项目分配")])],1)],1)],1)],1)]),e._v(" "),r("el-main",[r("el-row",[r("el-col",{attrs:{span:4}},[r("el-tree",{attrs:{data:e.departmentTree,props:e.defaultProps},on:{"node-click":e.handleNodeClick}})],1),e._v(" "),r("el-col",{attrs:{span:20}},[r("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],staticStyle:{width:"100%"},attrs:{data:e.userList,"row-key":"id",border:"",fit:"","highlight-current-row":""}},[r("el-table-column",{attrs:{align:"center",label:"ID",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.id))])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"用户编码"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.userNum))])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"用户姓名"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.userName))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"手机号",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.mobile))])]}}])})],1),e._v(" "),r("div",{staticClass:"pagination-container"},[r("el-pagination",{attrs:{background:"","current-page":e.listQuery.page,"page-sizes":[10,20,30,50],"page-size":e.listQuery.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.listQuery,"page",t)}}})],1)],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"项目分配",visible:e.isVisible,"close-on-click-modal":!1,width:"50%"},on:{"update:visible":function(t){e.isVisible=t}}},[r("el-form",{ref:"userForm",staticClass:"demo-ruleForm",attrs:{model:e.userForm,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"部门",prop:"deparmentId"}},[r("el-select",{attrs:{placeholder:"选择部门",filterable:"",loading:e.departmentLoading},on:{change:e.changeDepartment},model:{value:e.userForm.deparmentId,callback:function(t){e.$set(e.userForm,"deparmentId",t)},expression:"userForm.deparmentId"}},e._l(e.deparmentList,function(e){return r("el-option",{key:e.id,attrs:{label:e.departmentName,value:e.id}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"员工",prop:"userId"}},[r("el-select",{attrs:{placeholder:"选择员工",filterable:"",loading:e.userLoading},on:{change:e.changeUser},model:{value:e.userForm.userId,callback:function(t){e.$set(e.userForm,"userId",t)},expression:"userForm.userId"}},e._l(e.allUser,function(e){return r("el-option",{key:e.id,attrs:{label:e.userName,value:e.id}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"项目",prop:"projectIds"}},[r("el-transfer",{attrs:{titles:["所有项目","已选项目"],props:{key:"id",label:"projectName"},data:e.projectList},model:{value:e.userForm.projectIds,callback:function(t){e.$set(e.userForm,"projectIds",t)},expression:"userForm.projectIds"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("userForm")}}},[e._v("保存")])],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var c=r("/Xao")(o,l,!1,function(e){r("AE1b")},"data-v-0d70993e",null);t.default=c.exports}});