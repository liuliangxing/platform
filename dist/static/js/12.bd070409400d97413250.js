webpackJsonp([12,40],{"1j2f":function(e,t,o){var r=o("JkPW");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);o("8bSs")("1cafe21c",r,!0)},"65kI":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o("n1LB"),i=o("STSY"),s=o("dVeB"),a={components:{addRole:r.default},data:function(){return{isVisible:!1,role:{},total:0,title:"角色添加",roleList:[],projectList:[],listQuery:{name:"",pageIndex:1,pageSize:10}}},methods:{stop:function(e,t){this.tableData[t].projectStatus=3},closeDialog:function(){this.isVisible=!1,this.getRoleList()},edit:function(e){this.isVisible=!0,this.role=e,this.title="角色修改"},add:function(){this.role={},this.isVisible=!0},deleteRole:function(e){console.log(e)},getRoleList:function(){var e=this;Object(i.a)(this.listQuery).then(function(t){e.roleList=t.dataObject.roleList,e.total=t.dataObject.total}).catch(function(t){408===t.status?e.$router.push("/408"):Object(s.Message)({message:t,type:"error",duration:3e3})})},handleSizeChange:function(e){this.listQuery.pageSize=e,this.getRoleList()},handleCurrentChange:function(e){this.listQuery.pageIndex=e,this.getRoleList()}},mounted:function(){this.getRoleList()}},n={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"dashboard-editor-container"},[o("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small"},on:{click:e.add}},[e._v("添加角色")]),e._v(" "),o("el-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.roleList,border:""}},[o("el-table-column",{attrs:{prop:"id",label:"ID"}}),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"角色名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"projectId",label:"所属项目"}}),e._v(" "),o("el-table-column",{attrs:{prop:"createDate",label:"创建时间"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"text",size:"small"},on:{click:function(o){e.edit(t.row)}}},[e._v("修改")]),e._v(" "),o("el-button",{attrs:{type:"text",size:"small"},on:{click:function(o){e.deleteRole(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),o("div",{staticClass:"pagination-container"},[o("el-pagination",{attrs:{background:"","current-page":e.listQuery.page,"page-sizes":[10,20,30,50],"page-size":e.listQuery.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.listQuery,"page",t)}}})],1),e._v(" "),o("el-dialog",{attrs:{title:e.title,visible:e.isVisible,"close-on-click-modal":!1,width:"50%"},on:{"update:visible":function(t){e.isVisible=t}}},[e.isVisible?o("add-Role",{attrs:{role:e.role},on:{close:function(t){e.closeDialog()}}}):e._e()],1)],1)},staticRenderFns:[]};var l=o("/Xao")(a,n,!1,function(e){o("XfcQ")},"data-v-2df2d159",null);t.default=l.exports},JkPW:function(e,t,o){(e.exports=o("BkJT")(!1)).push([e.i,"\n.dashboard-editor-container[data-v-504d9f06] {\n  padding: 20px;\n  width: 100%;\n}\n",""])},XfcQ:function(e,t,o){var r=o("q1+F");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);o("8bSs")("e5018d28",r,!0)},n1LB:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o("dVeB"),i=o("STSY"),s=o("Odk1"),a={props:{role:{type:Object,default:{}}},data:function(){return{roleForm:{id:"",name:"",roleId:"",projectId:0,authoritiesIds:[]},projectList:[],authorityList:[],authorityTree:[],defaultCheckKeys:[],defaultProps:{children:"children",label:"label"},rules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10个字符",trigger:"blur"}],projectId:[{required:!0,message:"请选择项目",trigger:"change"}]}}},created:function(){this.roleForm=this.role},watch:{role:function(){this.roleForm=this.role}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var o=t.$refs.tree.getCheckedNodes(),s=t.$refs.tree.getHalfCheckedNodes(),a=[];if(o.length>0&&o.forEach(function(e){a.push(e.id)}),s.length>0&&s.forEach(function(e){a.push(e.id)}),!(a.length>0))return;t.roleForm.authoritiesIds=a,t.roleForm.roleId=t.roleForm.id,t.roleForm.id?Object(i.d)(t.roleForm).then(function(e){Object(r.Message)({message:"角色修改成功~",type:"success",duration:3e3})}).catch(function(e){408===e.status?t.$router.push("/408"):Object(r.Message)({message:e,type:"error",duration:3e3})}):Object(i.b)(t.roleForm).then(function(e){Object(r.Message)({message:"角色添加成功~",type:"success",duration:3e3})}).catch(function(e){408===e.status?t.$router.push("/408"):Object(r.Message)({message:e,type:"error",duration:3e3})}),t.$emit("close")}})},closeDialog:function(e){this.$emit("close")},changeProject:function(e){var t=this;Object(s.c)(e).then(function(e){t.authorityTree=e.dataObject.vos}).catch(function(e){408===e.status?t.$router.push("/408"):Object(r.Message)({message:e,type:"error",duration:3e3})})},getProjectList:function(){var e=this;Object(s.d)().then(function(t){e.projectList=t.dataObject.projectsList}).catch(function(t){e.$router.push("/408")})},getRoleAuthotitesList:function(e){var t=this;Object(i.c)(e).then(function(e){var o=e.dataObject.roleAuthoritiesList,r=[];o&&o.length>0&&o.forEach(function(e){o.filter(function(t){return e.id!==t.parentId})||r.push(e.authoritiesId)}),t.defaultCheckKeys=r}).catch(function(e){408===e.status?t.$router.push("/408"):Object(r.Message)({message:e,type:"error",duration:3e3})})}},mounted:function(){this.getProjectList(),this.roleForm.projectId&&this.changeProject(this.roleForm.projectId),this.roleForm.id&&this.getRoleAuthotitesList(this.roleForm.id)}},n={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"dashboard-editor-container"},[o("el-form",{ref:"roleForm",staticClass:"demo-ruleForm",attrs:{model:e.roleForm,rules:e.rules,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[o("el-input",{model:{value:e.roleForm.name,callback:function(t){e.$set(e.roleForm,"name",t)},expression:"roleForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"所属项目",prop:"projectId"}},[o("el-select",{attrs:{placeholder:"选择项目"},on:{change:e.changeProject},model:{value:e.roleForm.projectId,callback:function(t){e.$set(e.roleForm,"projectId",t)},expression:"roleForm.projectId"}},e._l(e.projectList,function(e){return o("el-option",{key:e.id,attrs:{label:e.projectName,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"权限"}},[o("el-tree",{ref:"tree",attrs:{data:e.authorityTree,"show-checkbox":"","node-key":"id","default-checked-keys":e.defaultCheckKeys,props:e.defaultProps}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("roleForm")}}},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]};var l=o("/Xao")(a,n,!1,function(e){o("1j2f")},"data-v-504d9f06",null);t.default=l.exports},"q1+F":function(e,t,o){(e.exports=o("BkJT")(!1)).push([e.i,"\n.dashboard-editor-container[data-v-2df2d159] {\n  padding: 20px;\n  width: 100%;\n}\n",""])}});