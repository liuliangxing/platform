webpackJsonp([40],{"1j2f":function(e,t,r){var o=r("JkPW");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);r("8bSs")("1cafe21c",o,!0)},JkPW:function(e,t,r){(e.exports=r("BkJT")(!1)).push([e.i,"\n.dashboard-editor-container[data-v-504d9f06] {\n  padding: 20px;\n  width: 100%;\n}\n",""])},n1LB:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("dVeB"),s=r("STSY"),a=r("Odk1"),i={props:{role:{type:Object,default:{}}},data:function(){return{roleForm:{id:"",name:"",roleId:"",projectId:0,authoritiesIds:[]},projectList:[],authorityList:[],authorityTree:[],defaultCheckKeys:[],defaultProps:{children:"children",label:"label"},rules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10个字符",trigger:"blur"}],projectId:[{required:!0,message:"请选择项目",trigger:"change"}]}}},created:function(){this.roleForm=this.role},watch:{role:function(){this.roleForm=this.role}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var r=t.$refs.tree.getCheckedNodes(),a=t.$refs.tree.getHalfCheckedNodes(),i=[];if(r.length>0&&r.forEach(function(e){i.push(e.id)}),a.length>0&&a.forEach(function(e){i.push(e.id)}),!(i.length>0))return;t.roleForm.authoritiesIds=i,t.roleForm.roleId=t.roleForm.id,t.roleForm.id?Object(s.d)(t.roleForm).then(function(e){Object(o.Message)({message:"角色修改成功~",type:"success",duration:3e3})}).catch(function(e){408===e.status?t.$router.push("/408"):Object(o.Message)({message:e,type:"error",duration:3e3})}):Object(s.b)(t.roleForm).then(function(e){Object(o.Message)({message:"角色添加成功~",type:"success",duration:3e3})}).catch(function(e){408===e.status?t.$router.push("/408"):Object(o.Message)({message:e,type:"error",duration:3e3})}),t.$emit("close")}})},closeDialog:function(e){this.$emit("close")},changeProject:function(e){var t=this;Object(a.c)(e).then(function(e){t.authorityTree=e.dataObject.vos}).catch(function(e){408===e.status?t.$router.push("/408"):Object(o.Message)({message:e,type:"error",duration:3e3})})},getProjectList:function(){var e=this;Object(a.d)().then(function(t){e.projectList=t.dataObject.projectsList}).catch(function(t){e.$router.push("/408")})},getRoleAuthotitesList:function(e){var t=this;Object(s.c)(e).then(function(e){var r=e.dataObject.roleAuthoritiesList,o=[];r&&r.length>0&&r.forEach(function(e){r.filter(function(t){return e.id!==t.parentId})||o.push(e.authoritiesId)}),t.defaultCheckKeys=o}).catch(function(e){408===e.status?t.$router.push("/408"):Object(o.Message)({message:e,type:"error",duration:3e3})})}},mounted:function(){this.getProjectList(),this.roleForm.projectId&&this.changeProject(this.roleForm.projectId),this.roleForm.id&&this.getRoleAuthotitesList(this.roleForm.id)}},n={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"dashboard-editor-container"},[r("el-form",{ref:"roleForm",staticClass:"demo-ruleForm",attrs:{model:e.roleForm,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[r("el-input",{model:{value:e.roleForm.name,callback:function(t){e.$set(e.roleForm,"name",t)},expression:"roleForm.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"所属项目",prop:"projectId"}},[r("el-select",{attrs:{placeholder:"选择项目"},on:{change:e.changeProject},model:{value:e.roleForm.projectId,callback:function(t){e.$set(e.roleForm,"projectId",t)},expression:"roleForm.projectId"}},e._l(e.projectList,function(e){return r("el-option",{key:e.id,attrs:{label:e.projectName,value:e.id}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"权限"}},[r("el-tree",{ref:"tree",attrs:{data:e.authorityTree,"show-checkbox":"","node-key":"id","default-checked-keys":e.defaultCheckKeys,props:e.defaultProps}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("roleForm")}}},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]};var c=r("/Xao")(i,n,!1,function(e){r("1j2f")},"data-v-504d9f06",null);t.default=c.exports}});