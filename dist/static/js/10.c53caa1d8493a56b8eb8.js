webpackJsonp([10,26],{"04rP":function(e,t,r){(e.exports=r("BkJT")(!1)).push([e.i,"\n.dashboard-editor-container[data-v-e2644c94] {\n  padding: 20px;\n  width: 100%;\n}\n",""])},"5ybE":function(e,t,r){"use strict";t.b=function(e){return Object(i.a)({url:o.a.GET_DEPARTMENT_LIST_URL,method:"post",data:e})},t.c=function(e){return Object(i.a)({url:o.a.GET_USERLIST_BY_DEPARTMENTID_URL,method:"post",data:{departmentId:e}})},t.a=function(e){return Object(i.a)({url:o.a.GET_DEPARTMENT_AUTHOTIZE_URL,method:"post",data:e})};var i=r("vLgD"),o=r("FN8c")},"8xEa":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("dVeB"),o=r("L870"),s=r("Odk1"),a={props:{permission:{type:Object,default:{}}},data:function(){return{permissionForm:{id:"",name:"",projectId:0,pid:0,notes:""},projectList:[],roleList:[],authorityList:[],rules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:3,max:50,message:"长度在 3 到 50个字符",trigger:"blur"}],notes:[{required:!0,message:"请输入权限描述",trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10个字符",trigger:"blur"}],projectId:[{required:!0,message:"请选择项目",trigger:"change"}]}}},created:function(){this.permissionForm=this.permission},watch:{permission:function(){this.permissionForm=this.permission}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){e&&(t.permissionForm.id?Object(o.g)(t.permissionForm).then(function(e){Object(i.Message)({message:"权限修改成功~",type:"success",duration:3e3})}).catch(function(e){408===e.status?t.$router.push("/408"):Object(i.Message)({message:e,type:"error",duration:3e3})}):Object(o.f)(t.permissionForm).then(function(e){Object(i.Message)({message:"权限添加成功~",type:"success",duration:3e3})}).catch(function(e){408===e.status?t.$router.push("/408"):Object(i.Message)({message:e,type:"error",duration:3e3})}),t.$emit("close"))})},closeDialog:function(e){this.$emit("close")},getProjectList:function(){var e=this;Object(s.d)().then(function(t){e.projectList=t.dataObject.projectsList}).catch(function(t){e.$router.push("/408")})},changeProject:function(e){var t=this;Object(s.c)(e).then(function(e){t.authorityList=e.dataObject.authoritiesList,console.log(t.authorityList)}).catch(function(e){408===e.status?t.$router.push("/408"):Object(i.Message)({message:e,type:"error",duration:3e3})})}},mounted:function(){this.getProjectList(),this.permissionForm.projectId&&this.changeProject(this.permissionForm.projectId)}},n={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"dashboard-editor-container"},[r("el-form",{ref:"permissionForm",staticClass:"demo-ruleForm",attrs:{model:e.permissionForm,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"权限名称",prop:"name"}},[r("el-input",{model:{value:e.permissionForm.name,callback:function(t){e.$set(e.permissionForm,"name",t)},expression:"permissionForm.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"权限描述",prop:"notes"}},[r("el-input",{model:{value:e.permissionForm.notes,callback:function(t){e.$set(e.permissionForm,"notes",t)},expression:"permissionForm.notes"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"所属项目",prop:"projectId"}},[r("el-select",{attrs:{placeholder:"选择项目"},on:{change:e.changeProject},model:{value:e.permissionForm.projectId,callback:function(t){e.$set(e.permissionForm,"projectId",t)},expression:"permissionForm.projectId"}},e._l(e.projectList,function(e){return r("el-option",{key:e.id,attrs:{label:e.projectName,value:e.id}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"上级权限"}},[r("el-select",{attrs:{placeholder:"选择上级权限"},model:{value:e.permissionForm.pid,callback:function(t){e.$set(e.permissionForm,"pid",t)},expression:"permissionForm.pid"}},e._l(e.authorityList,function(e){return r("el-option",{key:e.id,attrs:{label:e.notes,value:e.id}})}))],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("permissionForm")}}},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]};var c=r("/Xao")(a,n,!1,function(e){r("qr4j")},"data-v-e2644c94",null);t.default=c.exports},BMqf:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("8xEa"),o=r("L870"),s=r("Odk1"),a=r("5ybE"),n=r("STSY"),c=r("vMJZ"),l=r("dVeB"),u={components:{addAuthorities:i.default},data:function(){return{isVisible:!1,showAuthorize:!1,permission:{},title:"权限添加",authorityTree:[],selectedArr:[],authorityList:[],projectList:[],roleList:[],employeeList:[],deparmentList:[],projectAuthoritiesList:[],projectAuthoritiesTree:[],total:0,loading:!1,listQuery:{pid:"",projectId:"",pageIndex:1,pageSize:10},authorizeForm:{projectId:"",authotizeType:0,roleId:"",userId:"",departmentId:"",authoritiesIds:[]},defaultProps:{children:"children",label:"label"},rules:{projectId:[{required:!0,message:"请选择项目",trigger:"change"}],roleId:[{required:!0,message:"请选择角色",trigger:"change"}],authotizeType:[{required:!0,message:"请选择授权类型",trigger:"change"}],userId:[{required:!0,message:"请选员工",trigger:"change"}],departmentId:[{required:!0,message:"请选部门",trigger:"change"}]}}},methods:{handleNodeClick:function(e){this.listQuery.projectId=e.projectId,this.listQuery.pid=e.authoritieId,this.getAuthorityList()},getProjectAuthoritiesTree:function(){var e=this;Object(s.a)().then(function(t){e.projectAuthoritiesTree=t.dataObject.projectAuthortiesTree}).catch(function(t){408===t.status?e.$router.push("/408"):Object(l.Message)({message:t.response.data.message,type:"error",duration:3e3})})},closeDialog:function(){this.isVisible=!1,this.getAuthorityList()},edit:function(e){this.isVisible=!0,this.permission=e,this.title="权限修改"},add:function(){this.permission={},this.isVisible=!0,this.title="权限添加"},deletePermisson:function(e){var t=this;this.$confirm("此操作可能会导致其他的权限被删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(o.b)(e.id).then(function(e){Object(l.Message)({message:"权限删除成功~",type:"success",duration:3e3})}).catch(function(e){408===e.status?t.$router.push("/408"):Object(l.Message)({message:e.response.data.message,type:"error",duration:3e3})})}).catch(function(){console.log("取消")})},getAuthorityList:function(){var e=this;Object(o.a)(this.listQuery).then(function(t){e.authorityList=t.dataObject.authoritiesList,e.total=t.dataObject.total}).catch(function(t){408===t.status?e.$router.push("/408"):Object(l.Message)({message:t.response.data.message,type:"error",duration:3e3})})},handleSizeChange:function(e){this.listQuery.pageSize=e,this.getAuthorityList()},handleCurrentChange:function(e){this.listQuery.pageIndex=e,this.getAuthorityList()},authorize:function(){this.showAuthorize=!0,this.authorizeForm={},this.authorityTree=[],this.getProjectList()},getProjectList:function(){var e=this;Object(s.d)().then(function(t){e.projectList=t.dataObject.projectsList}).catch(function(t){e.$router.push("/408")})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var r=t.$refs.tree.getCheckedNodes(),i=[];r.length>0&&(r.forEach(function(e){i.push(e.id)}),t.authorizeForm.authoritiesIds=i),"1"===t.authorizeForm.authotizeType?Object(o.userAuthorize)(t.authorizeForm).then(function(e){t.showAuthorize=!1,Object(l.Message)({message:"授权成功~",type:"success",duration:3e3})}).catch(function(e){t.$router.push("/408")}):Object(a.a)(t.authorizeForm).then(function(e){t.showAuthorize=!1,Object(l.Message)({message:"授权成功~",type:"success",duration:3e3})}).catch(function(e){t.$router.push("/408")})}})},projectAuthortiesList:function(e){var t=this;Object(s.c)(e).then(function(e){t.authorityTree=e.dataObject.vos}).catch(function(e){t.$router.push("/408")}),Object(s.b)(e).then(function(e){t.roleList=e.dataObject.roleList}).catch(function(e){t.$router.push("/408")})},changeRole:function(e){var t=this;Object(n.c)(e).then(function(e){var r=e.dataObject.roleAuthoritiesList,i=[];r.length>0&&r.forEach(function(e){i.push(e.authoritiesId)}),t.selectedArr=i}).catch(function(e){t.$router.push("/408")})},getDepartmentList:function(){var e=this;Object(a.b)().then(function(t){e.deparmentList=t.dataObject.departmentsList}).catch(function(t){408===t.status?e.$router.push("/408"):Object(l.Message)({message:t,type:"error",duration:3e3})})},getAllUserList:function(){var e=this;Object(c.getAllUserList)().then(function(t){e.employeeList=t.dataObject.usersList}).catch(function(t){408===t.status?e.$router.push("/408"):Object(l.Message)({message:t,type:"error",duration:3e3})})}},mounted:function(){this.getAuthorityList(),this.getDepartmentList(),this.getAllUserList(),this.getProjectAuthoritiesTree()}},d={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"dashboard-editor-container"},[r("el-row",[r("el-col",{attrs:{span:5}},[r("el-tree",{attrs:{data:e.projectAuthoritiesTree,props:e.defaultProps},on:{"node-click":e.handleNodeClick}})],1),e._v(" "),r("el-col",{attrs:{span:19}},[r("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small"},on:{click:e.authorize}},[e._v("授权")]),e._v(" "),r("el-button",{staticStyle:{float:"right","margin-right":"10px"},attrs:{type:"primary",size:"small"},on:{click:e.add}},[e._v("添加权限")]),e._v(" "),r("el-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.authorityList,border:""}},[r("el-table-column",{attrs:{prop:"id",label:"ID"}}),e._v(" "),r("el-table-column",{attrs:{prop:"name",label:"权限名称"}}),e._v(" "),r("el-table-column",{attrs:{prop:"notes",label:"权限描述"}}),e._v(" "),r("el-table-column",{attrs:{prop:"projectId",label:"项目名称"}}),e._v(" "),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){e.edit(t.row)}}},[e._v("修改")]),e._v(" "),r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){e.deletePermisson(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),r("div",{staticClass:"pagination-container"},[r("el-pagination",{attrs:{background:"","current-page":e.listQuery.page,"page-sizes":[10,20,30,50],"page-size":e.listQuery.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.listQuery,"page",t)}}})],1)],1)],1),e._v(" "),r("el-dialog",{attrs:{title:e.title,visible:e.isVisible,"close-on-click-modal":!1,width:"50%"},on:{"update:visible":function(t){e.isVisible=t}}},[e.isVisible?r("add-Authorities",{attrs:{permission:e.permission},on:{close:function(t){e.closeDialog()}}}):e._e()],1),e._v(" "),r("el-dialog",{attrs:{title:"授权",visible:e.showAuthorize,"close-on-click-modal":!1,top:"10vh",width:"50%"},on:{"update:visible":function(t){e.showAuthorize=t}}},[r("el-form",{ref:"authorizeForm",staticClass:"demo-ruleForm",attrs:{model:e.authorizeForm,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"授权类型",prop:"authotizeType"}},[r("el-radio-group",{model:{value:e.authorizeForm.authotizeType,callback:function(t){e.$set(e.authorizeForm,"authotizeType",t)},expression:"authorizeForm.authotizeType"}},[r("el-radio",{attrs:{label:"1"}},[e._v("员工")]),e._v(" "),r("el-radio",{attrs:{label:"2"}},[e._v("部门")])],1)],1),e._v(" "),1==e.authorizeForm.authotizeType?r("el-form-item",{attrs:{label:"员工"}},[r("el-select",{attrs:{placeholder:"选择员工",filterable:"",loading:e.loading},model:{value:e.authorizeForm.userId,callback:function(t){e.$set(e.authorizeForm,"userId",t)},expression:"authorizeForm.userId"}},e._l(e.employeeList,function(e){return r("el-option",{key:e.id,attrs:{label:e.userName,value:e.id}})}))],1):e._e(),e._v(" "),2==e.authorizeForm.authotizeType?r("el-form-item",{attrs:{label:"部门",prop:"departmentId"}},[r("el-select",{attrs:{placeholder:"选择部门",filterable:"",loading:e.loading},model:{value:e.authorizeForm.departmentId,callback:function(t){e.$set(e.authorizeForm,"departmentId",t)},expression:"authorizeForm.departmentId"}},e._l(e.deparmentList,function(e){return r("el-option",{key:e.id,attrs:{label:e.departmentName,value:e.id}})}))],1):e._e(),e._v(" "),r("el-form-item",{attrs:{label:"项目",prop:"projectId"}},[r("el-select",{attrs:{placeholder:"选择项目"},on:{change:e.projectAuthortiesList},model:{value:e.authorizeForm.projectId,callback:function(t){e.$set(e.authorizeForm,"projectId",t)},expression:"authorizeForm.projectId"}},e._l(e.projectList,function(e){return r("el-option",{key:e.id,attrs:{label:e.projectName,value:e.id}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"角色"}},[r("el-select",{attrs:{placeholder:"选择角色"},on:{change:e.changeRole},model:{value:e.authorizeForm.roleId,callback:function(t){e.$set(e.authorizeForm,"roleId",t)},expression:"authorizeForm.roleId"}},e._l(e.roleList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"权限"}},[r("el-tree",{ref:"tree",attrs:{data:e.authorityTree,"show-checkbox":"","node-key":"id","default-checked-keys":e.selectedArr,props:e.defaultProps}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("authorizeForm")}}},[e._v("授权")])],1)],1)],1)],1)},staticRenderFns:[]};var h=r("/Xao")(u,d,!1,function(e){r("xvxR")},"data-v-0852688d",null);t.default=h.exports},qr4j:function(e,t,r){var i=r("04rP");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);r("8bSs")("c620fe28",i,!0)},xvxR:function(e,t,r){var i=r("y3UH");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);r("8bSs")("68174c17",i,!0)},y3UH:function(e,t,r){(e.exports=r("BkJT")(!1)).push([e.i,"\n.dashboard-editor-container[data-v-0852688d] {\n  padding: 20px;\n  width: 100%;\n}\n",""])}});